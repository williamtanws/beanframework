<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
	layout:decorate="~{${@environment.getProperty('layout.backoffice')}}">
<head>
<title th:utext="#{module.employee.session}"></title>
</head>
<body>
	<th:block layout:fragment="content">
		<section class="content">
			<div class="row">
				<th:block layout:insert="~{common/adminlte/common/component/alert :: custom}"></th:block>
			</div>
			<div class="row">
				<div class="col-md-12">
					<div class="box box-solid">
						<!-- /.box-header -->
						<div class="">
							<div class="box-group" id="accordion">
								<!-- we are adding the .panel class so bootstrap.js collapse plugin detects it -->
								<div class="panel box box-primary">
									<div class="box-header with-border">
										<h4 class="box-title">
											<span th:class="@{${@environment.getProperty('module.employee.session.icon')}}"></span>
											&nbsp;&nbsp;
											<span th:text="#{module.employee.session}"></span>
										</h4>
									</div>
									<div id="collapseOne" th:class="'panel-collapse collapse in'">
										<div class="box-body">
											<div class="row">
												<div class="col-md-12">
													<div class="box box-solid">
														<div class="box-body bg-gray">
															<div class="row">
																<div class="col-xs-12" style="text-align: right">
																	<form role="form" th:action="@{${@environment.getProperty('path.employee.session')}}" method="post">
																		<input type="hidden" name="deleteall">
																		<button type="submit" class="btn btn-danger" th:text="#{module.employee.expireall}" sec:authorize="hasAuthority('employeesession_delete')"></button>
																	</form>
																</div>
															</div>
														</div>
														<!-- /.box-header -->
													</div>
												</div>
											</div>
											<table id="usersessions" class="table table-bordered table-hover">
												<thead>
													<tr>
														<th th:text="#{module.employee.id}"></th>
														<th th:text="#{module.employee.session.id}"></th>
														<th th:text="#{module.employee.session.lastrequest}"></th>
														<th width="1%" class="action" th:text="#{module.backoffice.action}"></th>
													</tr>
												</thead>
												<tbody>
													<tr th:each="row : ${sessions}">
														<th scope="row">
															<a sec:authorize="hasAuthority('employee_read')" th:href="@{${@environment.getProperty('path.employee')}(uuid=${row.principalEmployee.uuid})}" th:text="${row.principalEmployee.id}"></a>
															<span sec:authorize="!hasAuthority('employee_read')" th:text="${row.principalEmployee.id}"></span>
														</th>
														<td>
															<th:block th:each="row2 : ${row.sessionInformations}">
																<span th:text="${row2.sessionId}"></span>
															</th:block>
														</td>
														<td>
															<th:block th:each="row2 : ${row.sessionInformations}">
																<span th:text="${#dates.format(row2.lastRequest, 'yyyy-MM-dd, hh:mm:ss a')}"></span>
																<br>
															</th:block>
														</td>
														<td>
															<form role="form" th:action="@{${@environment.getProperty('path.employee.session')}}" method="post">
																<input type="hidden" name="delete">
																<input type="hidden" name="uuid" th:value="${row.principalEmployee.uuid}">
																<button type="submit" class="btn btn-block btn-danger btn-sm" th:text="#{module.employee.expirenow}"></button>
															</form>
														</td>
													</tr>
												</tbody>
											</table>
										</div>
									</div>
								</div>
							</div>
						</div>
						<!-- /.box-body -->
					</div>
				</div>
			</div>
		</section>
	</th:block>
	<th:block layout:fragment="js">
		<script th:inline="javascript">
			/*<![CDATA[*/
			
			var locale = /*[[${#locale}]]*/;
				
			$(function() {
				$('#usersessions')
						.DataTable(
								{
									"language" : {
										"url" : "/static/common/plugin/datatables/language/"+locale+".json"
									},
									"paging" : true,
									"lengthChange" : false,
									"pageLength" : 20,
									"searching" : true,
									"ordering" : true,
									"info" : true,
									"autoWidth" : false,
									"aoColumnDefs" : [ {
										'bSortable' : false,
										'aTargets' : [ 'action', 'text-holder' ]
									} ]
								});
			});
			/*]]>*/
		</script>
	</th:block>
</body>
</html>