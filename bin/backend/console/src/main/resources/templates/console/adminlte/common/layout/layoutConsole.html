<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title layout:title-pattern="$CONTENT_TITLE | $LAYOUT_TITLE" th:utext="#{module.console}"></title>
<!-- Tell the browser to be responsive to screen width -->
<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
<link rel="shortcut icon" type="image/x-icon" th:href="${@environment.getProperty('favicon')}" />
<!-- Bootstrap 3.3.7 -->
<link rel="stylesheet" th:href="@{/static/adminlte/bower_components/bootstrap/dist/css/bootstrap.min.css}">
<!-- Font Awesome -->
<link rel="stylesheet" th:href="@{/static/adminlte/bower_components/font-awesome/css/font-awesome.min.css}">
<!-- Ionicons -->
<link rel="stylesheet" th:href="@{/static/adminlte/bower_components/Ionicons/css/ionicons.min.css}">
<!-- Bootstrap time Picker -->
<link rel="stylesheet" th:href="@{/static/adminlte/plugins/timepicker/bootstrap-timepicker.min.css}">
<!-- Select2 -->
<link rel="stylesheet" th:href="@{/static/adminlte/bower_components/select2/dist/css/select2.min.css}">
<!-- DataTables -->
<link rel="stylesheet" th:href="@{/static/adminlte/bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css}">
<!-- Bootstrap Datetimepicker -->
<link rel="stylesheet" th:href="@{/static/common/plugin/bootstrap-datetimepicker/build/css/bootstrap-datetimepicker.min.css}">
<!-- Theme style -->
<link rel="stylesheet" th:href="@{/static/adminlte/dist/css/AdminLTE.min.css}">
<!-- iCheck -->
<link rel="stylesheet" th:href="@{/static/adminlte/plugins/iCheck/square/blue.css}">
<!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
<link rel="stylesheet" th:href="@{/static/adminlte/dist/css/skins/_all-skins.min.css}">
<!-- Pace style -->
<link rel="stylesheet" th:href="@{/static/adminlte/plugins/pace/themes/white/pace-theme-minimal.css}">
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js}"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js}"></script>
  <![endif]-->
<!-- Google Font -->
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">

<link rel="stylesheet" th:href="@{/static/common/common.css}">

<!-- jQuery 3 -->
<script th:src="@{/static/adminlte/bower_components/jquery/dist/jquery.min.js}"></script>
<!-- Bootstrap 3.3.7 -->
<script th:src="@{/static/adminlte/bower_components/bootstrap/dist/js/bootstrap.min.js}"></script>
<!-- Select2 -->
<script th:src="@{/static/adminlte/bower_components/select2/dist/js/select2.full.min.js}"></script>
<!-- date-range-picker -->
<script th:src="@{/static/adminlte/bower_components/moment/min/moment.min.js}"></script>
<script th:src="@{/static/adminlte/bower_components/bootstrap-daterangepicker/daterangepicker.js}"></script>
<!-- bootstrap datepicker -->
<script th:src="@{/static/adminlte/bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js}"></script>
<!-- bootstrap time picker -->
<script th:src="@{/static/adminlte/plugins/timepicker/bootstrap-timepicker.min.js}"></script>
<!-- SlimScroll -->
<script th:src="@{/static/adminlte/bower_components/jquery-slimscroll/jquery.slimscroll.min.js}"></script>
<!-- FastClick -->
<script th:src="@{/static/adminlte/bower_components/fastclick/lib/fastclick.js}"></script>
<!-- AdminLTE App -->
<script th:src="@{/static/adminlte/dist/js/adminlte.min.js}"></script>
<!-- iCheck -->
<script th:src="@{/static/adminlte/plugins/iCheck/icheck.min.js}"></script>
<!-- PACE -->
<script th:src="@{/static/adminlte/plugins/pace/pace.min.js}"></script>
<!-- Jquery Validator -->
<script th:src="@{/static/common/js/jquery.validate.js}"></script>
<!-- DataTables -->
<script th:src="@{/static/adminlte/bower_components/datatables.net/js/jquery.dataTables.min.js}"></script>
<script th:src="@{/static/adminlte/bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js}"></script>
<!-- Bootstrap Datetimepicker -->
<script th:src="@{/static/common/plugin/bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js}"></script>
<!-- CK Editor -->
<script th:src="@{/static/adminlte/bower_components/ckeditor/ckeditor.js}"></script>

</head>
<body class="hold-transition skin-blue layout-top-nav">
	<!-- Site wrapper -->
	<div class="wrapper">
		<!-- Header -->
		<th:block th:insert="${@environment.getProperty('fragement.console.main.header')} :: header"></th:block>

		<!-- Content Wrapper. Contains page content -->
		<th:block th:insert="${@environment.getProperty('fragement.console.content.wrapper')} :: wrapper"></th:block>

		<!-- Footer -->
		<th:block th:insert="${@environment.getProperty('fragement.console.main.footer')} :: footer"></th:block>

		<!-- Sidebar -->
		<th:block th:insert="${@environment.getProperty('fragement.console.control.sidebar')} :: sidebar"></th:block>
	</div>
	<!-- ./wrapper -->
	<th:block layout:fragment="pace">
		<script th:inline="javascript">
			/*<![CDATA[*/
			$(document).ajaxStart(function() {
				Pace.restart();
			});
			/*]]>*/
		</script>
	</th:block>
	<script th:inline="javascript">
		/*<![CDATA[*/
		/* Global javascript here*/
		
		$(function () {
		    $('input').iCheck({
		      checkboxClass: 'icheckbox_square-blue',
		      radioClass: 'iradio_square-blue',
		      increaseArea: '20%' // optional
		    });
	    });

		function changeLocale(locale) {
			var url = window.location.href.split('#')[0];
		    url = String(url.replace(
		        /&?locale=([^&]$|[^&]*)/i, ""));
		    if (window.location.href.indexOf('?') > -1) {
		        url = url + '&locale=' + locale;
		    } else {
		        url = url + '?locale=' + locale;
		    }
		
		    window.location.href = url;
		}
		
		function changeTab(tab){
			var baseUrl = window.location.href.split('#')[0];
			window.location.replace( baseUrl + '#tab_' + tab );
			sessionStorage.setItem("tabUrl", '#tab_'+tab);
		}
		
		function activeTab(){
			if(window.location.hash != ''){
				var baseUrl = window.location.href.split('#')[0];
				window.location.replace( baseUrl + window.location.hash );
				
				if($('.nav-tabs a[href="' + window.location.hash + '"]').length == 0) {
					sessionStorage.removeItem("tabUrl");
					window.location.hash = '';
				}
				else{
				    $('.nav-tabs a[href="' + window.location.hash + '"]').tab('show');
				}
			}
			else{
				var tabUrl = sessionStorage.getItem("tabUrl");
				if(tabUrl !== null && tabUrl !== undefined && tabUrl !== 'null'){
					var baseUrl = window.location.href.split('#')[0];
					window.location.replace( baseUrl + tabUrl );
					
				    
				    if($('.nav-tabs a[href="' + tabUrl + '"]').length == 0) {
						sessionStorage.removeItem("tabUrl");
						window.location.hash = '';
					}
					else{
						$('.nav-tabs a[href="' + tabUrl + '"]').tab('show');
					}
				}
			}
		}
		
		activeTab();
		
		$(document).ready(function() {
			
			var timeout = /*[[@{${@environment.getProperty('server.servlet.session.timeout')}}]]*/;
			timeout = timeout * 1000;
		
			var loginPath = /*[[@{${@environment.getProperty('path.console.login')}}]]*/;
			loginPath = loginPath + '?timeout';
			
			var checktimeoutPath = /*[[@{${@environment.getProperty('path.console.checktimeout')}}]]*/;
			
			$(document).ajaxError(function (e, xhr, options) {
		        if (xhr.status == 403) {
		            window.location.href = loginPath;
		        }
		    });
						
			function checkTimeout(){
				$.ajax({
				    type : "GET",
				    url : checktimeoutPath,
				    statusCode: {
				        401: function() {
							window.location.href = loginPath;
				        }
				    }
				});
			}
			
			setInterval(checkTimeout, timeout+5000);
			
			$('.datetimepicker').each(function(){
			    $(this).datetimepicker({
			    	format: 'DD/MM/YYYY hh:mm A'
			    });
			});
			
			$( document ).ajaxError(function( event, jqxhr, settings, exception ) {
			    if ( jqxhr.status== 401 ) {
			    	window.location.href = loginPath;
			    }
			});
		});
		/*]]>*/
	</script>
	<script type="text/javascript" th:src="@{/static/common/common.js}"></script>
	<th:block layout:fragment="js"></th:block>
</body>
</html>
