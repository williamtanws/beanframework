<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">
<body>
	<th:block layout:fragment="history">
		<div class="row">
			<div class="box-body chat">
				<!-- chat item -->
				<div class="item" th:each="revision : ${revisions}" >
					<img th:if="${revision[0].lastModifiedBy != null}" th:src="@{${@environment.getProperty('path.employee.profile.picture')}(type='thumbnail',uuid=${revision[0].lastModifiedBy.uuid})}"
						alt="user image" class="online">
					<img th:with="defaultavatar=${@environment.getProperty('module.backoffice.configuration.avatar.default')}" th:if="${revision[0].lastModifiedBy == null}"
						th:src="@{${@Config.get('defaultavatar','/static/common/img/avatar.png')}}" alt="user image" class="online">

					<p class="message">
						<span class="name">
							<th:block th:if="${revision[0].lastModifiedBy == null}">
								<span th:text="#{module.backoffice.system}+': '"></span>
							</th:block>
							<th:block th:if="${revision[0].lastModifiedBy != null}">
								<span sec:authorize="!hasAuthority('employee_read')" th:text="${revision[0].lastModifiedBy.name}+': '"></span>
								<a sec:authorize="hasAuthority('employee_read')" th:href="@{${@environment.getProperty('path.employee')}(uuid=${revision[0].lastModifiedBy.uuid})}+'#tab_general'"
									th:text="${revision[0].lastModifiedBy.name}+': '"></a>
							</th:block>
							<span class="text-muted" th:text="#{module.backoffice.history.__${revision[2]}__}"></span>
							<small class="text-muted pull-right">
								<i class="fa fa-clock-o"></i>
								<span th:if="${revision[0].lastModifiedDate == null}" th:text="*{createdDate != null} ? *{#dates.format(createdDate, ' dd MMMM yyyy, hh:mma')}"></span>
								<span th:if="${revision[0].lastModifiedDate != null}" th:text="${#dates.format(revision[0].lastModifiedDate, ' dd MMMM yyyy, hh:mma')}"></span>
							</small>
						</span>
						<th:block th:each="property : ${revision[3]}">
							<th:block th:if="${property == 'password'}">
								<span th:text="#{module.history.__${property}__}+' '"></span>
								<span class="fa fa-long-arrow-right"></span>
								<span>******</span>
							</th:block>
							<th:block th:if="${property != 'password'}">
								<span th:text="#{module.history.__${property}__}+' '"></span>
								<span class="fa fa-long-arrow-right"></span>
								<span th:text="' '+${revision[0].__${property}__}"></span>
							</th:block>
							<br>
						</th:block>
						<th:block th:each="field : ${fieldRevisions}" th:if="${field[1].id == revision[1].id}">
							<th:block th:each="property : ${field[3]}">
								<span th:text="${field[0].dynamicField.name} + '('+${field[0].dynamicField.language.id}+') '"></span><span class="fa fa-long-arrow-right"></span><span th:text="' '+${field[0].__${property}__}"></span>
								<br>
							</th:block>
						</th:block>
					</p>
				</div>
				<!-- /.item -->
			</div>
		</div>
	</th:block>
</body>
</html>