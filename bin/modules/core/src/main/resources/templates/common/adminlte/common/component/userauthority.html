<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">
<body>
	<th:block layout:fragment="userauthority">
		<table id="userauthorityTable" class="table table-bordered">
			<thead>
				<tr>
					<th th:text="#{module.userpermission}"></th>
					<th th:each="userRight: ${userRights}">
						<span th:text="${userRight.name}"></span>
					</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="userPermission: ${userPermissions}">
					<th th:text="${userPermission.name}"></th>
					<td th:each="userRight: ${userRights}">
						<th:block th:each="userAuthority,itrStat : *{userAuthorities}" th:if="*{uuid == null}">
							<input type="hidden" th:name="'userAuthorities['+${itrStat.index}+'].uuid'" th:value="${userAuthority.uuid}">
							<input type="hidden" th:name="'userAuthorities['+${itrStat.index}+'].id'" th:value="*{id}+'_'+${userAuthority.userPermission.id + '_' + userAuthority.userRight.id }">
							<input type="hidden" th:name="'userAuthorities['+${itrStat.index}+'].userPermission.uuid'" th:value="${userAuthority.userPermission.uuid}">
							<input type="hidden" th:name="'userAuthorities['+${itrStat.index}+'].userRight.uuid'" th:value="${userAuthority.userRight.uuid}">
							<input type="checkbox" th:name="'userAuthorities['+${itrStat.index}+'].enabled'">
						</th:block>
						<th:block th:each="userAuthority,itrStat : *{userAuthorities}" th:if="*{uuid != null}">
							<th:block th:if="${userAuthority.userRight.uuid == userRight.uuid && userAuthority.userPermission.uuid == userPermission.uuid}">
								<input type="hidden" th:name="'userAuthorities['+${itrStat.index}+'].uuid'" th:value="${userAuthority.uuid}">
								<input type="hidden" th:name="'userAuthorities['+${itrStat.index}+'].id'" th:value="*{id}+'_'+${userAuthority.userPermission.id + '_' + userAuthority.userRight.id }">
								<input type="hidden" th:name="'userAuthorities['+${itrStat.index}+'].userGroup.uuid'" th:value="*{uuid}">
								<input type="hidden" th:name="'userAuthorities['+${itrStat.index}+'].userPermission.uuid'" th:value="${userAuthority.userPermission.uuid}">
								<input type="hidden" th:name="'userAuthorities['+${itrStat.index}+'].userRight.uuid'" th:value="${userAuthority.userRight.uuid}">
								<input type="checkbox" th:name="'userAuthorities['+${itrStat.index}+'].enabled'" th:checked="${userAuthority.enabled}">
							</th:block>
						</th:block>
					</td>
				</tr>
			</tbody>
		</table>
		<script th:inline="javascript">
		    /*<![CDATA[*/
		    	
		    var locale = /*[[${#locale}]]*/;
		    
		    $(document).ready(function() {
		    	
		    	$('#userauthorityTable').DataTable({
		    		  'language' : {
				        'url' : '/static/common/plugin/datatables/language/'+locale+'.json'
				      },
		    	      'pageLength'  : 10,
		    	      'paging'      : true,
		    	      'lengthChange': false,
		    	      'searching'   : true,
		    	      'ordering'    : true,
		    	      'info'        : true,
		    	      'autoWidth'   : true
		    	})
		    });
		    /*]]>*/
		</script>
	</th:block>
</body>
</html>